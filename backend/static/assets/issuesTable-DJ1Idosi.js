import{a as B,u as F,r as p,l as R,p as O,c as n,b as e,d as f,w as x,j as g,o,g as r,h as k,e as V,F as S,q as C,t as v,n as j,v as M}from"./index-BC6Xn69q.js";import"./joi-browser.min-BtPDWMFX.js";const U={class:"mx-auto"},A=e("div",{class:"font-bold text-[18px]"}," Davomat ",-1),L={class:"mt-3 w-full overflow-auto"},$=e("thead",null,[e("tr",null,[e("th",{class:"w-[150px]"},"Rollar"),e("th",{class:"w-[220px]"}," Sana"),e("th",{class:"w-[170px]"},"Sabab"),e("th")])],-1),q={class:"w-[80px]"},G={class:"p-5"},H={class:"flex justify-center"},J=e("span",{class:"material-symbols-outlined"}," search ",-1),P={class:"mt-3"},Y=e("th",{class:"w-[20px]"},"â„–",-1),K=e("th",{class:"w-[100px]"},"F.I",-1),Q={class:"text-center"},W={class:"font-bold"},X={key:0},ae={__name:"issuesTable",setup(Z){const E=B();F();let u=p(null);const w=p([]);let d=p([118313526e4,Date.now()]),i=p(null),y=p([]),_=p([]),I=p([{label:"Hammasi",value:void 0,disabled:!1},{label:"Sababli",value:"true"},{label:"Sababsiz",value:"false"}]);R(u,async(s,a)=>{console.log(s)});const N=async function(){try{const s=localStorage.token;let a=await fetch(`${window.base}/admin/get_role`,{method:"GET",headers:{"Content-type":"application/json","-x-token":s}});if(a.status==401)return E.push("/admin/login");a.status==200&&(w.value=[{label:"Roleni tanglang",value:"-1",disabled:!0}],a=await a.json(),a.forEach(l=>w.value.push({label:l.name,value:l.id})))}catch(s){console.log(s)}};O(async()=>{await N()}),R(d,(s,a)=>{});let T=async()=>{let s=[];d.value.forEach((c,b)=>{const h=new Date(c),t=String(h.getMonth()+1).padStart(2,"0"),m=h.getFullYear(),D=String(h.getDate()).padStart(2,"0");s[b]=`${m}-${t}-${D}`}),console.log(u.value),console.log(s),console.log(i.value),i.value==null&&(i.value=void 0);const a=localStorage.token;let l=await fetch(`${window.base}/admin/get_issues/find`,{method:"POST",headers:{"Content-type":"application/json","-x-token":a},body:JSON.stringify({timeBegin:s[0],timeEnd:s[1],roleID:u.value,reason:i.value})});if(l.status==401)return E.push("/admin/login");l.status==200&&(y.value=[],_.value=[],l=await l.json(),console.log(l),l.forEach(c=>{c.time.forEach(b=>{_.value.push({time:b})})}),l.forEach(c=>y.value.push(c)),console.log(_.value))};return(s,a)=>{const l=g("n-select"),c=g("n-date-picker"),b=g("n-button"),h=g("n-table");return o(),n("div",U,[A,e("div",L,[f(h,{bordered:!0,"single-line":!1},{default:x(()=>[$,e("tbody",null,[e("td",q,[f(l,{placeholder:"Rollarni tanlang",value:r(u),"onUpdate:value":a[0]||(a[0]=t=>k(u)?u.value=t:u=t),size:"medium",options:w.value},null,8,["value","options"])]),e("td",null,[f(c,{value:r(d),"onUpdate:value":a[1]||(a[1]=t=>k(d)?d.value=t:d=t),type:"daterange",clearable:""},null,8,["value"])]),e("td",G,[f(l,{value:r(i),"onUpdate:value":a[2]||(a[2]=t=>k(i)?i.value=t:i=t),options:r(I)},null,8,["value","options"])]),e("td",null,[e("div",H,[f(b,{onClick:r(T),disabled:!r(d),type:"primary"},{default:x(()=>[J,V(" Izlash ")]),_:1},8,["onClick","disabled"])])])])]),_:1})]),e("div",P,[f(h,{bordered:!0,"single-line":!1},{default:x(()=>[e("thead",null,[e("tr",null,[Y,K,(o(!0),n(S,null,C(r(_),(t,m)=>(o(),n("th",{class:"w-[20px]",key:m},[e("div",Q,v(new Date(t.time).toISOString().split("T")[0]),1)]))),128))])]),e("tbody",null,[(o(!0),n(S,null,C(r(y),(t,m)=>(o(),n("tr",{key:m},[e("td",null,v(m+1),1),e("td",W,v(t.lastname)+" "+v(t.firstname),1),(o(!0),n(S,null,C(r(_).length,(D,z)=>(o(),n("td",null,[t.time.includes(r(_)[z].time)?(o(),n("span",X,[Array.isArray(t.reason)?(o(),n("span",{key:1,class:j(["font-bold",t.reason?"text-green-600":"text-red-600"])},v(t.detail),3)):(o(),n("span",{key:0,class:j(["font-bold",t.reason?"text-green-600":"text-red-600"])},v(t.detail),3))])):M("",!0)]))),256))]))),128))])]),_:1})])])}}};export{ae as default};
