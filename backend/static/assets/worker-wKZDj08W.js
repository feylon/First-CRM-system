import{l as G,r as p,j as b,o as I,c as z,d as u,w as _,e as N,h,g as s,m as Z,u as q,a as Q,i as Y,p as H,b as e,t as l,F as L,q as K}from"./index-BC6Xn69q.js";import{J as se}from"./joi-browser.min-BtPDWMFX.js";var V={};Object.defineProperty(V,"__esModule",{value:!0});var X=V.joiPasswordExtendCore=void 0;function oe(P){return{type:"string",base:P.string(),messages:{"password.minOfUppercase":"{#label} should contain at least {#min} uppercase character","password.minOfSpecialCharacters":"{#label} should contain at least {#min} special character","password.minOfLowercase":"{#label} should contain at least {#min} lowercase character","password.minOfNumeric":"{#label} should contain at least {#min} numeric character","password.noWhiteSpaces":"{#label} should not contain white spaces","password.onlyLatinCharacters":"{#label} should only contain latin characters","password.doesNotInclude":"{#label} should not contain any of the following: {#patterns}"},rules:{minOfUppercase:{method(t){return this.$_addRule({name:"minOfUppercase",args:{min:t}})},args:[{name:"min",assert:t=>typeof t=="number"&&!isNaN(t),message:"must be a number"}],validate:(t,o,{min:m=0})=>new RegExp(`(?=(.*[A-Z]){${m}})`).test(t)?t:o.error("password.minOfUppercase",{min:m})},minOfLowercase:{method(t){return this.$_addRule({name:"minOfLowercase",args:{min:t}})},args:[{name:"min",assert:t=>typeof t=="number"&&!isNaN(t),message:"must be a number"}],validate:(t,o,{min:m=0})=>new RegExp(`(?=(.*[a-z]){${m}})`).test(t)?t:o.error("password.minOfLowercase",{min:m})},minOfSpecialCharacters:{method(t){return this.$_addRule({name:"minOfSpecialCharacters",args:{min:t}})},args:[{name:"min",assert:t=>typeof t=="number"&&!isNaN(t),message:"must be a number"}],validate:(t,o,{min:m=0})=>t.length-(t.match(/[a-zA-Z0-9]/g)||[]).length<m?o.error("password.minOfSpecialCharacters",{min:m}):t},minOfNumeric:{method(t){return this.$_addRule({name:"minOfNumeric",args:{min:t}})},args:[{name:"min",assert:t=>typeof t=="number"&&!isNaN(t),message:"must be a number"}],validate:(t,o,{min:m=0})=>new RegExp(`(?=(.*[0-9]){${m}})`,"g").test(t)?t:o.error("password.minOfNumeric",{min:m})},noWhiteSpaces:{validate:(t,o)=>new RegExp(" ","g").test(t)?o.error("password.noWhiteSpaces"):t},onlyLatinCharacters:{validate:(t,o)=>new RegExp(`[^a-zA-Z0-9!@#$%^&*()_+\\-=\\[\\]{};':"\\\\|,.<>\\/? ]`,"g").test(t)?o.error("password.onlyLatinCharacters"):t},doesNotInclude:{method(t){return this.$_addRule({name:"doesNotInclude",args:{patterns:t}})},args:[{name:"patterns",assert:t=>Array.isArray(t),message:"must be an array"}],validate:(t,o,{patterns:m=[]})=>{const c=m.filter(v=>new RegExp(v,"g").test(t));return c.length>0?o.error("password.doesNotInclude",{patterns:c.join(", ")}):t}}}}}X=V.joiPasswordExtendCore=oe;const de={__name:"propsEditWorker",props:{id:Number},setup(P){const t=P;G(t,(v,j)=>{const{id:y}=v;console.log(y)});let o={width:"600px"},m={content:"soft",footer:"soft"},c=p(!1);return console.log(t.id),(v,j)=>{const y=b("n-button"),w=b("n-modal");return I(),z("div",null,[u(y,{onClick:j[0]||(j[0]=x=>h(c)?c.value=!0:c=!0)},{default:_(()=>[N(" Start me up ")]),_:1}),u(w,{show:s(c),"onUpdate:show":j[1]||(j[1]=x=>h(c)?c.value=x:c=x),class:"custom-card",preset:"card",style:Z(s(o)),title:"Modal",bordered:!1,size:"huge",segmented:s(m)},{"header-extra":_(()=>[N(" Oops! ")]),footer:_(()=>[N(" Footer ")]),default:_(()=>[N(" Content ")]),_:1},8,["show","style","segmented"])])}}},re={class:"container mt-4 ms-2 mb-3 font-bold text-[18px] select-none"},ie=e("th",null,"â„–",-1),ue=e("th",null,null,-1),ce={class:"flex justify-end"},me={class:""},pe={class:"flex justify-around"},fe={class:"w-[50%] gap-4 flex justify-around items-center"},he=e("div",{class:"font-bold text-[13px]"},"Ismi ",-1),ve={class:"w-[70%]"},_e={class:"w-[50%] gap-4 flex justify-around items-center"},we=e("div",{class:"font-bold text-[13px]"},"Familiya ",-1),ge={class:"w-[70%]"},be={class:"flex justify-around mt-3"},ye={class:"w-[50%] gap-4 flex justify-around items-center"},ke=e("div",{class:"font-bold text-[13px]"},"Email ",-1),xe={class:"w-[70%]"},$e={class:"w-[50%] gap-4 flex justify-around items-center"},Se=e("div",{class:"font-bold text-[13px]"},"Parol ",-1),je={class:"w-[70%]"},Ce={class:"flex justify-around mt-4"},Re={class:"w-[50%] gap-4 flex justify-around items-center"},Oe=e("div",{class:"font-bold text-[13px]"},"Tug'ilgan kun ",-1),Ne={class:"w-[70%]"},Ee={class:"w-[50%] gap-4 flex justify-around items-center"},Ue=e("div",{class:"font-bold text-[13px]"},"Viloyat ",-1),Ie={class:"w-[70%]"},ze={class:"flex justify-around mt-4"},Te={class:"w-[50%] gap-4 flex justify-around items-center"},Ae=e("div",{class:"font-bold text-[13px]"},"Tuman ",-1),Pe={class:"w-[70%]"},De={class:"w-[50%] gap-4 flex justify-around items-center"},Le=e("div",{class:"font-bold text-[13px]"},"Role ",-1),Me={class:"w-[70%]"},We={class:"flex justify-around mt-4"},Fe={class:"w-[50%] gap-4 flex justify-around items-center"},Je=e("div",{class:"font-bold text-[13px]"},"Telefon ",-1),Ve={class:"w-[70%]"},Be={class:"flex justify-end mt-3"},Ge={__name:"worker",setup(P){se.extend(X);let t={width:"600px"},o={content:"soft",footer:"soft"};const m=q();Q();let c=p([]),v=p(!1);const{t:j}=Y.global,y=p([]),w=p([]);let x=p(!1),T=p([]),E=p(null),R=p(null),d=p(null),f=p(null),g=p(null),O=p(null),U=p(null),C=p([]),r=p(null);async function M(){const i=new Date(f.value),n=i.getFullYear(),$=(i.getMonth()+1).toString().padStart(2,"0"),S=i.getDate().toString().padStart(2,"0"),F=`${n}-${$}-${S}`;let D={email:E.value,firstname:R.value,lastname:d.value,brithday:F,phone:g.value,role_id:O.value,password:U.value,viloyat:C.value,tuman:r.value};try{let k=await fetch(`${window.base}/admin/add_worker`,{method:"POST",headers:{"Content-type":"application/json","-x-token":localStorage.token},body:JSON.stringify(D)});if(k.status==202)return k=await k.json(),m.warning(k.error);k.status==201&&(m.success(`${R.value} muvaqiyatli yaratildi`),E.value=null,R.value=null,d.value=null,f.value=null,g.value=null,O.value=null,U.value=null,C.value=null,r.value=null,v.value=!1,W())}catch(k){console.log(k)}}G(C,async function(i,n){x.value=!0,w.value=[],r.value=null;let $=await fetch(`${window.base}/admin/regions/districts/${C.value}`);$=await $.json(),$.forEach(S=>{w.value.push({label:S.name_uz,value:S.id.toString()})}),x.value=!1});let A=p(1),B=p(1),ee=localStorage.token,W=async function(){let i=await fetch(`${window.base}/admin/get_worker?${new URLSearchParams({page:A.value,size:10}).toString()}`,{method:"GET",headers:{"Content-type":"application/json","-x-token":ee}});i.status==200&&(i=await i.json(),B.value=Math.trunc(i[0].total/10+1),c.value=[],i.forEach(n=>c.value.push(n)))};return H(async()=>{W();let i=await fetch(`${window.base}/admin/regions`);i=await i.json(),i.forEach(S=>{y.value.push({label:S.name_uz,value:S.id.toString()})});let n=localStorage.token,$=await fetch(`${window.base}/admin/get_role`,{method:"GET",headers:{"Content-type":"application/json","-x-token":n}});$.status==200&&($=await $.json(),$.forEach(S=>{T.value.push({label:S.name,value:S.id.toString()})}))}),(i,n)=>{const $=b("n-switch"),S=b("n-table"),F=b("n-pagination"),D=b("n-button"),k=b("n-input"),te=b("n-date-picker"),J=b("n-select"),ae=b("n-modal");return I(),z(L,null,[e("div",null,[e("div",re,[N(l(i.$t("Workers"))+" ",1),u(S,{bordered:!1,"single-line":!1},{default:_(()=>[e("thead",null,[e("tr",null,[ie,e("th",null,l(i.$t("lastname")),1),e("th",null,l(i.$t("firstname")),1),e("th",null,l(i.$t("email")),1),e("th",null,l(i.$t("phone")),1),e("th",null,l(i.$t("birthday")),1),e("th",null,l(i.$t("viloyat")),1),e("th",null,l(i.$t("tuman")),1),e("th",null,l(i.$t("active")),1),ue])]),e("tbody",null,[(I(!0),z(L,null,K(s(c),(a,ne)=>(I(),z("tr",{key:a.id},[e("td",null,l(++ne)+" "+l(a.id),1),e("td",null,l(a.lastname),1),e("td",null,l(a.firstname),1),e("td",null,l(a.email),1),e("td",null,l(a.phone),1),e("td",null,l(new Date(a.brithday).toISOString().split("T")[0]),1),e("td",null,l(a.name_uz),1),e("th",null,l(a.tuman_lotin),1),e("th",null,[u($,{value:a.active,"onUpdate:value":le=>a.active=le,disabled:!0},null,8,["value","onUpdate:value"])]),e("th",null,[u(de,{id:a.id},null,8,["id"])])]))),128))])]),_:1}),u(F,{onChange:n[0]||(n[0]=a=>s(W)()),page:s(A),"onUpdate:page":n[1]||(n[1]=a=>h(A)?A.value=a:A=a),"page-count":s(B)},null,8,["page","page-count"]),e("div",ce,[u(D,{onClick:n[2]||(n[2]=a=>h(v)?v.value=!0:v=!0)},{default:_(()=>[N(l(i.$t("addWorker")),1)]),_:1})])])]),u(ae,{show:s(v),"onUpdate:show":n[12]||(n[12]=a=>h(v)?v.value=a:v=a),class:"custom-card",preset:"card",style:Z(s(t)),title:s(j)("addWorker"),bordered:!1,size:"huge",segmented:s(o),"aria-modal":"true"},{header:_(()=>[e("div",null,l(i.$t("addWorker")),1)]),action:_(()=>[e("div",me,[e("form",null,[e("div",pe,[e("div",fe,[he,e("div",ve,[u(k,{value:s(R),"onUpdate:value":n[3]||(n[3]=a=>h(R)?R.value=a:R=a)},null,8,["value"])])]),e("div",_e,[we,e("div",ge,[u(k,{value:s(d),"onUpdate:value":n[4]||(n[4]=a=>h(d)?d.value=a:d=a)},null,8,["value"])])])]),e("div",be,[e("div",ye,[ke,e("div",xe,[u(k,{value:s(E),"onUpdate:value":n[5]||(n[5]=a=>h(E)?E.value=a:E=a)},null,8,["value"])])]),e("div",$e,[Se,e("div",je,[u(k,{value:s(U),"onUpdate:value":n[6]||(n[6]=a=>h(U)?U.value=a:U=a),type:"password","show-password-on":"mousedown",placeholder:"Password",maxlength:100},null,8,["value"])])])]),e("div",Ce,[e("div",Re,[Oe,e("div",Ne,[u(te,{value:s(f),"onUpdate:value":n[7]||(n[7]=a=>h(f)?f.value=a:f=a),type:"date"},null,8,["value"])])]),e("div",Ee,[Ue,e("div",Ie,[u(J,{value:s(C),"onUpdate:value":n[8]||(n[8]=a=>h(C)?C.value=a:C=a),size:"medium",options:y.value},null,8,["value","options"])])])]),e("div",ze,[e("div",Te,[Ae,e("div",Pe,[u(J,{disabled:!!s(x),value:s(r),"onUpdate:value":n[9]||(n[9]=a=>h(r)?r.value=a:r=a),size:"medium",options:w.value},null,8,["disabled","value","options"])])]),e("div",De,[Le,e("div",Me,[u(J,{value:s(O),"onUpdate:value":n[10]||(n[10]=a=>h(O)?O.value=a:O=a),size:"medium",options:s(T)},null,8,["value","options"])])])]),e("div",We,[e("div",Fe,[Je,e("div",Ve,[u(k,{value:s(g),"onUpdate:value":n[11]||(n[11]=a=>h(g)?g.value=a:g=a)},null,8,["value"])])])]),e("div",Be,[u(D,{onClick:M,dashed:""},{default:_(()=>[N("Qo'shish")]),_:1})])])])]),_:1},8,["show","style","title","segmented"])],64)}}},Ze={class:"mb-6"},qe={class:"font-bold text-[20px] select-none"},Qe={class:"mt-4 ms-2 mb-3 font-bold text-[18px] select-none"},Ye=e("th",null,"â„–",-1),He=e("th",null,null,-1),Ke=["title"],Xe=e("span",{class:"material-symbols-outlined"}," edit ",-1),et={class:"text-green-600 font-bold"},tt={class:"w-[70%]"},at=e("span",{class:"material-symbols-outlined"}," edit ",-1),st={__name:"worker",setup(P){const{t}=Y.global;let o=p(""),m=p(),c=p(!1),v=q(),j=Q(),y,w=p(""),x=p([]);localStorage.getItem("token")&&(y=localStorage.getItem("token"));let T=async function(){let d=await fetch(`${window.base}/admin/get_role`,{method:"GET",headers:{"Content-type":"application/json","-x-token":y}});if(d.status==200&&(x.value=[],d=await d.json(),d.forEach(f=>{x.value.push(f)})),d.status==401)return localStorage.clear(),j.push("/admin/login")};const E=async function(){y=localStorage.getItem("token");let d=await fetch(`${window.base}/admin/add_role`,{method:"POST",headers:{"Content-type":"application/json","-x-token":y},body:JSON.stringify({name:w.value.trim()})});if(d.status==201&&(v.success(t("successAddRole")),w.value="",await T()),d.status==401)return localStorage.clear(),j.push("/admin/login");d.status==400&&(v.error(w.value+t("errorAddRole")),w.value="")},R=async function(d,f){y=localStorage.getItem("token");let g=await fetch(`${window.base}/admin/edit_roles/${d}`,{method:"POST",headers:{"Content-type":"application/json","-x-token":y},body:JSON.stringify({name:f.trim()})});if(g.status==200)return v.success(t("editRoleSuccess")),T(),c.value=!1;if(g.status==400&&v.error(f+t("errorAddRole")),g.status==401)return localStorage.clear(),j.push("/admin/login")};return H(async()=>{await T()}),(d,f)=>{const g=b("n-button"),O=b("n-input"),U=b("n-table"),C=b("n-modal");return I(),z(L,null,[e("div",Ze,[e("div",qe,l(d.$t("workersAndRoles")),1),u(Ge),e("div",Qe,l(d.$t("roles")),1),u(U,{class:"w-[90%] mx-auto"},{default:_(()=>[e("thead",null,[e("tr",null,[Ye,e("th",null,l(d.$t("NameOfRole")),1),e("th",null,l(d.$t("CreatedAtRole")),1),He])]),e("tbody",null,[(I(!0),z(L,null,K(s(x),(r,M)=>(I(),z("tr",{key:r.id},[e("td",null,l(M+1),1),e("td",null,l(r.name),1),e("td",{title:r.created_at},l(new Date(r.created_at).toISOString().split("T")[0]),9,Ke),e("td",null,[u(g,{dashed:"",onClick:A=>{h(c)?c.value=!0:c=!0,h(o)?o.value=r.name:o=r.name,h(m)?m.value=r.id:m=r.id}},{default:_(()=>[Xe]),_:2},1032,["onClick"])])]))),128)),e("tr",null,[e("td",null,[e("span",et,l(s(x).length+1),1)]),e("td",null,[e("div",tt,[u(O,{value:s(w),"onUpdate:value":f[0]||(f[0]=r=>h(w)?w.value=r:w=r),placeholder:d.$t("addNewRole")},null,8,["value","placeholder"])])]),e("td",null,[u(g,{onClick:f[1]||(f[1]=r=>E()),disabled:!(s(w).length>3),dashed:""},{default:_(()=>[N(l(d.$t("addRole")),1)]),_:1},8,["disabled"])])])])]),_:1})]),u(C,{show:s(c),"onUpdate:show":f[4]||(f[4]=r=>h(c)?c.value=r:c=r),preset:"dialog",title:"Dialog"},{header:_(()=>[e("div",null,l(d.$t("editrole")),1)]),action:_(()=>[e("div",null,[u(g,{onClick:f[3]||(f[3]=r=>R(s(m),s(o))),disabled:!(s(o).length>3),type:"primary"},{default:_(()=>[at,N(" "+l(d.$t("editrole")),1)]),_:1},8,["disabled"])])]),default:_(()=>[e("div",null,[u(O,{value:s(o),"onUpdate:value":f[2]||(f[2]=r=>h(o)?o.value=r:o=r)},null,8,["value"])])]),_:1},8,["show"])],64)}}};export{st as default};
